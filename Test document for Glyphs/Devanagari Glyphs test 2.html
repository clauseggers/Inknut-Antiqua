<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link rel="stylesheet" href="fonts.css" type="text/css" media="screen" title="no title" charset="utf-8">
<title>Devangari test</title>

<style type="text/css" media="screen">
html {
	-webkit-font-smoothing: subpixel-antialiased;
	text-rendering: optimizeLegibility;
}

body {
	background-color: #ffffff;
	color: rgba(0,0,0,1);
	font-family: "Letter Gothic Std", Monospaced;
	font-style: normal;
	font-weight: 300;
	font-size: 14px;
	line-height: 2em;
	text-align: left;
	margin-top: 2rem;
	margin-left: 2rem;
	margin-right: 2rem;
	margin-bottom: 2rem;
	-moz-font-feature-settings:"kern" 1, "liga" 1, "dlig" 1;
	-moz-font-feature-settings:"kern=1, liga=1, dlig=1";
	-ms-font-feature-settings:"kern" 1, "liga" 1, "dlig" 1;
	-o-font-feature-settings:"kern" 1, "liga" 1, "dlig" 1;
	-webkit-font-feature-settings:"kern" 1, "liga" 1, "dlig" 1;
	font-feature-settings:"kern" 1, "liga" 1, "dlig" 1;
}
.Glyphs {
	font-family: "FontToTest2";
	font-size: 3rem;
	line-height: 1.2em;
	color: rgba(255,0,0,0.5);
	display: block;
}

/*
Download Uttera and Chandas here http://www.sanskritweb.net/cakram/
Chandas font represents Southern (most commonly used today) style of Devanagari script. And Uttara font represents Northern style of Devanagari Script. These styles are sometimes also called Bombay (Southern, contemporary) and Calcutta (Northern, old) pen families accordingly.
*/

.ModelNorthern {
	font-family: "Uttara";
	font-size: 4rem;
	line-height: 1.2;
	color: rgba(0,170,0,0.5);
	display: block;
}
.ModelSouthern {
	font-family: "Chandas";
	font-size: 4rem;
	line-height: 1.2;
	color: rgba(0,170,0,0.5);
	display: block;
}
.AdobeDevanagari {
	font-family: "Adobe Devanagari";
	font-size: 4rem;
	line-height: 1.2;
	color: rgba(0,0,170,0.5);
	display: block;
}

.ss01 {
	-moz-font-feature-settings:"kern" 1, "ss01" 1;
	-moz-font-feature-settings:"kern=1, ss01=1";
	-ms-font-feature-settings:"kern" 1, "ss01" 1;
	-o-font-feature-settings:"kern" 1, "ss01" 1;
	-webkit-font-feature-settings:"kern" 1, "ss01" 1;
	font-feature-settings:"kern" 1, "ss01" 1;
}
.DONE {
	text-decoration: line-through;
	color: rgba(100,100,100,0.5) !important;
}

</style>

</head>

<body>
<div id="bodytext">

CES [14.10.14]</br>
The sequence ra+halant+zerowidthjoiner is no longer rendered correctly with the ‘eyelash’ ra. The first cluster is without the ZWJ, and the second with the ZWJ. The second should render the ‘eyelash’ ra.</br></br>
Also the Marathi string somehow manages to switch the order of the ya and the ra-deva.loclMR, and then delete the space character between the clusters. Also for Marathi *both* clusters should have the ra+halant substituted with the ‘eyelash’ ra.</br></br>
<span class="Glyphs">DFLT र्य र्‍य र्त्र्प</span></br>
<span class="lang" lang="mr"><span class="Glyphs">MR र्य र्‍य र्त्र्प</span></br></span>
<span class="AdobeDevanagari">DFLT र्य र्‍य र्त्र्प</span></br>
<span class="lang" lang="mr"><span class="AdobeDevanagari">MR र्य र्‍य र्त्र्प</span></br></span>

The half-form of the conjunct ta_ra-deva is named t_r-deva, and since does not render I’m guessing it has the wrong name. Since ta_ra-deva is already taken for the full-form conjunct, what should the half-form then be called? [14.10.14]</br></br>
<span class="Glyphs">र्य र्त्र्प ऱ्य </span></br>
<span class="ModelNorthern">र्य र्त्र्प ऱ्य </span></br>

CES [11.10.14] Georg it would appear that the fixes you made in regard to the use of ‘rakar’ made the fix underneath not work, so I added these strings of longer syllables to have something more structured to test. If you open this HTML-file in Sublime Text you get to see the individual characters of the Devanagari text-strings which is quite handy.</br></br>
Half-forms of ra-conjuncts are not used. They should be used in the normal way half-forms and conjunct are listed in the ‘half’ and ‘cjct’ features.</br></br>
Exampel: ta-deva halant-deva ra-deva halant-deva pa-deva (त्र्प) should in the ‘half’ feature have "sub ta_ra-deva halant-deva by t_r-deva;" and in the ‘cjct’ feature have "sub t-deva reph-deva by t_r-deva;"
</br></br>
<span class="Glyphs">DFLT त् त्र त्र्प र्प्र र् र्त र्त्र र्त्र्प र्त्र्प्र</span></br>
<span class="lang" lang="mr"><span class="Glyphs">MR त् त्र त्र्प र्प्र र् र्त र्त्र र्त्र्प र्त्र्प्र </span></br></span>
<span class="ModelSouthern">DFLT त् त्र त्र्प र्प्र र् र्त र्त्र र्त्र्प र्त्र्प्र</span></br>
<span class="AdobeDevanagari">DFLT त् त्र त्र्प र्प्र र् र्त र्त्र र्त्र्प र्त्र्प्र</span></br>
<span class="lang" lang="mr"><span class="AdobeDevanagari">MR त् त्र त्र्प र्प्र र् र्त र्त्र र्त्र्प र्त्र्प्र </span></span></br></br>

It would appear that a base-character + virama + ra should substitute the virama + ra with the rr-deva glyph. (CES: I need to find out if this is correct ortography or not something tells me it is, because the feature is in the font, but appears to be overridden by InDesign and Firefox.)</br></br>
Conjunct ga_ra_ya-deva is not rendered, instead a ra with virama is.</br></br>
Second issue is the placement of the virama under the ra and da. Please have a look at the ‘Notes on what needs to be fixed.txt’ document where I discuss these anchor issues. [28.09.14]</br></br>
CES [07.10.14]: Solution follows:</br>
The RPHF feature should have a special exception for Marathi where ra+halant is GSUB’d with reph-deva.loclMAR instead of reph-deva:</br>
script dev2;</br>
lookup Rphf_deva {</br>
	sub ra-deva halant-deva by reph-deva;</br>
} Rphf_deva;</br>
language SAN;</br>
lookup Rphf_deva;</br>
language MAR  exclude_dflt;</br>
lookup Rphf_MAR {</br>
	sub ra-deva halant-deva by reph-deva.loclMAR;</br>
} Rphf_MAR;</br>
language NEP;</br>
lookup Rphf_deva;</br>

script deva;</br>
lookup Rphf_deva;</br>
language SAN;</br>
lookup Rphf_deva;</br>
language MAR  exclude_dflt;</br>
lookup Rphf_MAR;</br>
language NEP;</br>
lookup Rphf_deva;</br></br>

<span class="Glyphs">DFLT पर्‍ प्र्प पर्‍या ग्र्य द् र् </span></br>
<span class="lang" lang="mr"><span class="Glyphs">MR पर्‍ प्र्प पर्‍या ग्र्य द् र् </span></span></br>
<span class="ModelNorthern">पर्‍ प्र्प पर्‍या ग्र्य द् र् </span></br>
<span class="ModelSouthern">पर्‍ प्र्प पर्‍या ग्र्य द् र् </span></br>
<span class="AdobeDevanagari">पर्‍ प्र्प पर्‍या ग्र्य द् र् </span></br>
<hr>

CES [11.10.14]</br>
When a nukta is in the syllable, the conjuncts containing ra (conjuncts with the ‘leg’) are not rendered with a nukta, but rather with the consonant, a nukta, and a rakar.</br></br>

<span class="Glyphs">DFLT ख्र ख़्र ख़्र ज्र ज़्र ज़्र ग्र ग़्र ग़्र य्र य़्र य़्र </span></br>
<span class="lang" lang="mr"><span class="Glyphs">MR ख्र ख़्र ख़्र ज्र ज़्र ज़्र ग्र ग़्र ग़्र य्र य़्र य़्र </span></br></span>
<span class="ModelSouthern">ख्र ख़्र ख़्र ज्र ज़्र ज़्र ग्र ग़्र ग़्र य्र य़्र य़्र </span></br>
<hr>

FIXED!</br>
Conjuncts d_bha_ra, d_ba_ra, and d_va_ra not rendered. [29.09.14]</br>
CES [05.10.14]: Solution follows:</br>
You have made RKRF add all those conjunct that end in ra-deva to the Rkrf1 lookup. Since RKRF is fired before CJCT you need to add conjuncts resulting from the ‘Rkrf1’ lookup to the CJCT.
</br>
Example for the sequence ‘da-deva halant-deva bha-deva halant-deva ra-deva’:</br>
First the sequence ‘bha-deva halant-deva ra-deva’ is made into a conjunct in the RKRF feature, in the first lookup ‘Rkrf1’:</br>
	sub bha-deva halant-deva ra-deva by bha_ra-deva;</br>
Then in the CJCT the sequence ‘da-deva halant-deva bha_ra-deva’ *should* be turned into the conjunct d_bha_ra-deva, like so:</br>
	sub da-deva halant-deva bha_ra-deva by d_bha_ra-deva;</br>
</br>
Same deal for all occurences of these ra-conjuncts made in the RKRF. Remember that in some cases, such as ‘bha_ra_ya-deva’, you have to do a full substitution (including halants) in CJCT:</br>
	sub bha_ra-deva halant-deva ya-deva by bha_ra_ya-deva;</br>
</br>
<span class="Glyphs">द्भ द्भ्र द्ब द्ब्र द्व्र </span></br>
<span class="ModelSouthern">द्भ द्भ्र द्ब द्ब्र द्व्र </span></br>
<hr>

CES [07.10.14]: Georg you didn’t include this bit of feature-code in the auto-feature generator. If I add it manually, then the rephs are not attached to the ‘top’ anchor. The ‘top’ anchor is placed in the stem of the aaMatra which is the stem-component in rVocalic and rrVocalic, so that should work as in all the rest of the glyphs using the aaMatra component…</br>
In the ‘ss01’ variations, the aaMatra is placed twice, but then Glyphs should just use the ‘top’ anchor from the last instance of the aaMatra (the right-most).</br></br>

ra + rVocalic should render as the rVocalic with a reph on top, and ra + rrVocalic should render as rrVocalic with a reph on top.</br></br>
For Marathi, la + lVocalic should render the lVocalic, and la + llVocalic should render llVocalic. For Hindi the lVocalic and llVocalic should just be placed below the stem. I made two glyphs called la_lVocalicMatra-deva.loclMAR and la_llVocalicMatra-deva.loclMAR, where lVocalic and llVocalic are placed as components, but they are not rendered in MR for la+l/llVocalic [01.10.14]</br></br>

CES [07.10.14]: Solution follows:</br>
Simple GSUB in CJCT:</br>
script dev2;</br>
lookup cjct_vocalic {</br>
	sub ra-deva' [rVocalicMatra-deva rrVocalicMatra-deva] by reph-deva;</br>
	sub reph-deva [rVocalicMatra-deva rrVocalicMatra-deva]' by [rVocalic-deva rrVocalic-deva];</br>
} cjct_vocalic;</br></br>

And then add that lookup to MAR and SAN.</br>
</br>
<span class="Glyphs">HI रृ रॄ ल लृ लॄ ऌ ॡ </span></br>
<span class="lang" lang="mr"><span class="Glyphs">MR रृ रॄ ल लृ लॄ ऌ ॡ </span></br></span>
<span class="ss01"><span class="Glyphs">HI+ss01 रृ रॄ ल लृ लॄ ऌ ॡ </span></br>
<span class="lang" lang="mr"><span class="Glyphs">MR+ss01 रृ रॄ ल लृ लॄ ऌ ॡ </span></br></span></span>
<span class="ModelNorthern">रृ रॄ ल लृ लॄ ऌ ॡ </span></br>
<span class="ModelSouthern">रृ रॄ ल लृ लॄ ऌ ॡ </span></br>
<span class="AdobeDevanagari">रृ रॄ ल लृ लॄ ऌ ॡ </span></br>
<hr>

‘Solved’ by adding SS10 to force this.</br>
Test of GSUB of special Devanagari-style latin punctuation. Is in the LOCL feature. Works for Hindi and Marathi – except the last glyph in a string of latin preceeding the nagari (which makes some sense), but not if that character is a beginning quote mark.</br></br>
Kerning also works, which is somewhat weird as it does not work in other contexts.</br></br>
Sanskrit does for some reason not work.</br></br>
NB: This feature does not work in InDesign CS6. It must be because InDesign’s implementation is buggy. [06.10.14]</br></br>
<span class="lang" lang="hi"><span class="Glyphs">HI ‘रृ’ “रॄ” ल- लृ–!!!???,.;</span></span></br>
<span class="lang" lang="mr"><span class="Glyphs">MR ‘रृ’ “रॄ” ल- लृ–!!!???,.</span></span></br>
<span class="lang" lang="sa"><span class="Glyphs">SA ‘रृ’ “रॄ” ल- लृ–!!!???,.</span></span></br>
<span class="Glyphs">NO LANG ‘रृ’ “रॄ” ल- लृ–!!!???,.</span></span></br>
<span class="ModelNorthern">DFLT ‘रृ’ “रॄ” ल- लृ–!!!???,.;:</span></br>
<span class="ModelSouthern">DFLT ‘रृ’ “रॄ” ल- लृ–!!!???,.;:</span></br>
<span class="AdobeDevanagari">NO LANG ‘रृ’ “रॄ” ल- लृ–!!!???,.;:</span></br>
<hr>

WORKS!</br>
Test of SS01 which switches relevant glyphs from Southern style to Northern style. [06.10.14]</br></br>
<span class="lang" lang="hi"><span class="Glyphs">HI ऄ ॲ अ आ ऋ ॠ ॳ ॶ ॷ झ ण ल </span></span></br>
<span class="lang" lang="hi"><span class="Glyphs"><span class="ss01">HI+SS01 ऄ ॲ अ आ ऋ ॠ ॳ ॶ ॷ झ ण ल </span></span></<span></span></br>
<span class="lang" lang="mr"><span class="Glyphs">MR ऄ ॲ अ आ ऋ ॠ ॳ ॶ ॷ झ ण ल </span></span></br>
<span class="lang" lang="mr"><span class="Glyphs"><span class="ss01">MR+SS01 ऄ ॲ अ आ ऋ ॠ ॳ ॶ ॷ झ ण ल </span></span></span></br>
<span class="lang" lang="sa"><span class="Glyphs">SA ऄ ॲ अ आ ऋ ॠ ॳ ॶ ॷ झ ण ल </span></span></br>
<span class="lang" lang="sa"><span class="Glyphs"><span class="ss01">SA+SS01 ऄ ॲ अ आ ऋ ॠ ॳ ॶ ॷ झ ण ल </span></span></span></br>
<span class="Glyphs">DFLT ऄ ॲ अ आ ऋ ॠ ॳ ॶ ॷ झ ण ल </span></br>
<span class="Glyphs"><span class="ss01">DFLT+SS01 ऄ ॲ अ आ ऋ ॠ ॳ ॶ ॷ झ ण ल </span></span></br>
<span class="ModelNorthern">DFLT ऄ ॲ अ आ ऋ ॠ ॳ ॶ ॷ झ ण ल </span></br>
<hr>

The special glyphs for da_uuMatra-deva, (ra_uuMatra-deva) and ha_uuMatra-deva are not used in combination with half-forms/conjuncts – or the wrong anchor is used. Please see ‘Notes on what needs to be fixed.txt’ on this anchor issue. [28.09.14]</br></br>
<span class="Glyphs">दू न्दू हू न्हू </span></br>
<span class="ModelNorthern">दू न्दू हू न्हू </span></br>
<hr>

LARGELY FIXED… I have made several changes to the CCMP and ABVS that in concert with legated matras solve most situations.[14.10.14]</br></br>
What do we do about collisions like this below? A calt GSUB to a separate glyph? [27.09.14]</br></br>
<span class="Glyphs">उँदै यौँ हीँ </span></br>
<span class="ModelNorthern">उँदै यौँ हीँ </span></br>
<hr>

The calculation of Velanti (iMatra- and iiMatra ‘bows’) seems to be off the mark in some rare instances. I have cleaned up the components and anchors in Inknut, but the below examples are still not correct for some reason (could it be that Glyphs does not iterate through the nested components to find the ‘top’ anchor?) [27.09.14]</br></br>
<span class="Glyphs">ड़ी पि ष्ट्री टी </span></br>
<span class="ModelNorthern">ड़ी पि ष्ट्री टी </span></br>
<hr>

FIXED!</br>
ss_pa_ra-deva conjunct not active in Indesign CS6 and Firefox. Does work in Safari. [26.09.14]</br></br>
<span class="Glyphs">No lang ष्प्र </span></br>
<span class="lang" lang="sa"><span class="Glyphs">Sanskrit ष्प्र </span></br>
<span class="ModelNorthern">Sanskrit ष्प्र </span></span></br>
<hr>

FIXED!</br>
For some reason these conjuncts do not work in InDesign CS6 nor in Firefox. It *does* work in Safari.</br>
Conjunct s_ta_ra will not appear in Glyphs, nor in FF and InDesign CS6. Same issue with the longer s_ta_ra_ya-deva and n_ta_ra-deva conjuncts. I tried naming it both s_t_r_ya-deva and s_ta_ra_ya-deva, but get same result. [24.09.14]</br></br>
<span class="Glyphs">स्त्र स्त्र्य न्त्र </span><span class="ModelNorthern">स्त्र स्त्र्य न्त्र </span></br>
<hr>

FIXED! (by adding an anchor)</br>
Position of the ‘leg’ component in the pa_ra and va_ra conjuncts are not correct in the generated fonts. It is correct in the Glyphs file. There is a ‘leg’ anchor in both the aaMatra-deva and the p-deva – the two components that the pa-deva is built from. The pa_ra-deva is built from the pa-deva + the ra-deva.leg [24.09.14]</br></br>
<span class="Glyphs">प्र व्र </span><span class="ModelNorthern">प्र व्र </span></br>
<hr>

Kerning(?) issue when setting a language. Seems like the entire kerning feature is turned off when a text is tagged with a language (any language, except Hindi which is not used in the OT-features, hence a text tagged with ‘hi’ falls back to base-devanagari). This is only true for Devanagari, not the latin.</br></br>
The kerning also fails in InDesign CS6 if a language that uses Devanagari is set. [25.10.14]</br></br>
<span class="Glyphs">Hindi ठीकाला परकारकहतहएउनका </span></br>
<span class="lang" lang="mr"><span class="Glyphs">Marathi ठीकाला परकारकहतहएउनका </span></span></br>
<hr>

FIXED!</br>
v_ra conjunct not enabled somewhere in the OT-features? [15.09.14]</br></br>
FIXED: use syntax [… v_va_ra_v …]</br></br>
<span class="Glyphs">व्र </span><span class="ModelNorthern">व्र </span></br>
<hr>

LARGELY FIXED… I have made several changes to the CCMP and ABVS that in concert with legated matras solve most situations.[14.10.14]</br></br>
I have made the compound diacritics as separate glyphs, and I can see that they are in the CCMP feature, but they do not render, neither in InDesign nor in Firefox. Please refer to the last page of the InDesign test-document for more examples. [01.10.14]</br></br>
GS: The only way I see is to make a precomposed glyph. [10.09.14]</br></br>
CES: Trying to make these compound diacritics as components… [29.10.14]</br></br>
CES: So I have made a selection of compound diacritial glyphs, and put this code in ABVS:</br>
script dev2;</br>
lookup Abvs1_devanagari {</br>
	sub [aiMatra-deva anusvara-deva eCandraMatra-deva] [aiMatra-deva anusvara-deva eCandraMatra-deva] [aiMatra-deva anusvara-deva eCandraMatra-deva] by aiMatra_candraBindu-deva;</br>
} Abvs1_devanagari;</br></br>

This works in Glyphs, but not in InDesign CS6 nor in Firefox [02.10.14].
</br></br>

<span class="Glyphs"> दैंॅ   दॅैं   दंॅै   दॅंै   दॅैं   दैॅं</span></br>

<span class="Glyphs">र्घ र्घॅ र्घं र्घऀ र्घॆ र्घॆं र्घॆॅं र्घँ र्घॅं र्घॕ </br>
र्घा र्घाॅ र्घां र्घाऀ र्घाॆ र्घाॆं र्घाॆॅं र्घाँ र्घाॅं र्घाॕ घौँ </span></br>
<span class="ModelNorthern">र्घ र्घॅ र्घं र्घऀ र्घॆ र्घॆं र्घॆॅं र्घँ र्घॅं र्घॕ </br>
र्घा र्घाॅ र्घां र्घाऀ र्घाॆ र्घाॆं र्घाॆॅं र्घाँ र्घाॅं र्घाॕ </span></br>
<span class="AdobeDevanagari">र्घ र्घॅ र्घं र्घऀ र्घॆ र्घॆं र्घॆॅं र्घँ र्घॅं र्घॕ </br>
र्घा र्घाॅ र्घां र्घाऀ र्घाॆ र्घाॆं र्घाॆॅं र्घाँ र्घाॅं र्घाॕ घौँ </span></br>
<hr>

</div>

</body>

</html>
